define(["view/quest/abstract-view","view/popup","view/quest/sub/_sub_vw_receive_item","util/navigate","util/language-message"],function(a,b,c,d,e){var f=a.extend({el:".btn-skip",events:{tap:"showSynopsis"},initialize:function(a){this.init(),this.scene_id=a.scene_id,this.forwardFlg=a.forwardFlg,this.nextUrl=a.nextUrl,this.areaId=a.areaId,this.completedQuestId=a.completed_quest_id,this.isTutorialScene=a.isTutorialScene||!1,this.locationId=a.location_id,this.nextFateQuestId=a.nextFateQuestId,this.bookmarkPage=a.bookmarkPage,this.redirectUrl=a.redirectUrl||"#mypage",this.isForceRedirect=a.isForceRedirect||!1},setSynopsis:function(a,b,c){var d=this;_.isEmpty(a)===!0&&"scene_evt180401_cp1_q1_s10"===this.scene_id?require(["util/language-message"],function(a){d.synopsisTitle=a.getMessage("revival002_exception_title")||""}):this.synopsisTitle=a,_.isObject(c)&&c.popupStyleType&&(this.popupStyleType=c.popupStyleType),this.synopsisBody=b},setOpenScene:function(a){this.open_scene_url=a},showSynopsis:function(){var a={title:this.synopsisTitle,synopsis:this.synopsisBody},c="";this.popupStyleType&&(c+=" pop-season-event"+this.popupStyleType);var d=this.isTutorialScene&&"scene_tutorial01"===this.scene_id;this.popView=new b({className:"pop-synopsis"+c,title:a.title,body:_.template($("#tpl-synopsis").html(),a),flagBtnCancel:1,flagBtnOk:+d,btnOkClassName:d?"btn-scene-skip":"",btnOkText:d?e.getMessage("btn-scene-skip"):""}),a.synopsis?(this.popView.render(),d||this.popView.$el.find(".prt-popup-footer").before($("#tpl-synopsis-buttons").html()),this.popView.popShow()):this.end(),this.trigger("tap")},setVwReceiveItemView:function(a){this.vwReceiveItemView=new c({seasonEventItemData:a}),this.addSubView(this.vwReceiveItemView);var b=this;this.listenToOnce(this.vwReceiveItemView,"popRemoveVwReceiveItem",function(){b.removeSubView(b.vwReceiveItemView),b.vwReceiveItemView.content_close(),b.end()})},end:function(){var a=this.vwReceiveItemView&&this.vwReceiveItemView.seasonEventItemData;if(a)return void this.vwReceiveItemView.readyPopReceiveItem();if(cjs.stage.sceneEffect&&cjs.stage.sceneEffect.removeAllEventListeners("tick"),cjs.stage.scenePrivate&&cjs.stage.scenePrivate.removeAllEventListeners("tick"),this.forwardFlg===window.SCENE_RETURN_ID_DEBUG){var b=location.href.split("?")[1];if("undefined"!=typeof b){var c=b.split("&");location.href=Game.baseUri+"debug/scenecheck/set_npc_id/"+c[0]+"?"+c[1]+"&"+c[2]}else location.href=Game.baseUri+"debug/scenecheck/set_scene_view?scene_id="+this.scene_id}else this.open_scene_url?(this.content_close(),Backbone.history.navigate(this.open_scene_url,!0)):this.isForceRedirect?d.hash(this.redirectUrl):(this.popView&&this.popView.popRemove(),this.fowardTo(this.forwardFlg,this.areaId,this.completedQuestId,this.locationId,null,this.nextFateQuestId,this.bookmarkPage,this.redirectUrl,this.scene_id))},setRedirectUrl:function(a){this.redirectUrl=a}});return f});