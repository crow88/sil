define(["view/popup","util/language-message"],function(a,b){var c={SELECT:"selectStyle",DISABLE:"disableStyle"},d="disabled",e=3;return a.extend({events:_.defaults({"tap .btn-unopen":"onTapUnopenStyle"},a.prototype.events),initialize:_.compose(a.prototype.initialize,function(a){var c=_.find(a.styleList,function(b){return a.currentStyle===b.style});this.targetStyle=_.filter(a.styleList,function(b){return a.currentStyle!==b.style}),this.options={className:"pop-npc-alter-style",title:b.getMessage("pop_alter_style_title"),body:_.template($("#tpl-pop-npc-alter-style").html(),{isArchive:a.isArchive,current:c,target:this.targetStyle})}}),getSelectedStyle:function(){return this.targetStyle[0]},isOpenedTarget:function(){return this.getSelectedStyle().is_open},canSetTarget:function(){return this.getSelectedStyle().can_set},updateConfirmText:function(){var a="",c="";this.isOpenedTarget()?this.canSetTarget()?a=b.getMessage("pop_alter_style_title_confirm_1"):(a=this.getSelectedStyle().set_conditions.reduce(function(a,b){return b.is_complete||(a.length&&(a+="<br>"),a+=b.comment),a},""),c=d):a=b.getMessage("pop_alter_style_title_confirm_0"),this.$el.find(".js-confirm-alter-style").addClass(c).html(a)},adjustDisplay:function(){var a=[];this.$el.find(".prt-style-wrapper").each(function(){var b=$(this).find(".txt-style-name"),c=b.height(),d=Math.round(c/2);b.css("margin-top",d-c+"px"),a.push(d+e)}),this.$el.find(".prt-styles").css("margin-top",_.max(a)+"px")},updateFooterButton:function(){this.$el.find(".prt-popup-footer").html(_.template($("#tpl-pop-npc-alter-style-footer").html(),{isEnable:this.isOpenedTarget()&&this.canSetTarget()}))},onTapUnopenStyle:function(){this.trigger(c.DISABLE,+this.getSelectedStyle().style)},popShow:_.compose(function(){this.updateConfirmText(),this.adjustDisplay(),this.updateFooterButton()},a.prototype.popShow),onPushOk:_.compose(a.prototype.popRemove,a.prototype.onPushOk,function(){this.trigger(c.SELECT,+this.getSelectedStyle().style)}),onPushClose:_.compose(a.prototype.popRemove,a.prototype.onPushClose),onPushCancel:_.compose(a.prototype.popRemove,a.prototype.onPushCancel)},{EVENT:c})});